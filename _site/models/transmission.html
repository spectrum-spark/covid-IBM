<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>COVID IBM: Waning Immunity - Transmission Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">COVID IBM: Waning Immunity</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../models/transmission.html" aria-current="page">Transmission Model</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../models/clinicaloutcomes.html">Clinical Outcomes Model</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../models/immunitymodel.html">Immunity Model</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Transmission Model</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>To model the transmission of COVID-19 throughout the population of interest we have extended a previous individual-based model <span class="citation" data-cites="reopening">(<a href="#ref-reopening" role="doc-biblioref"><strong>reopening?</strong></a>)</span> to account for loss of protection over time since vaccination. Waning of immunity is accounted for by explicitly modelling the boosting and decay of each individual’s neutralising antibody titre. This approach overcomes limitations of the typical SIRS model, where waning is modelled as an exponential distribution (or more generally as a phase type distribution), and enables us to investigate the possible impacts of variants of concern using the expected fold change in neutralising antibody titre.</p>
<p>Each individual within the simulation is constructed using a known age, their corresponding age bracket within the contact matrix, a list of their vaccination history and the decay rate of their neutralising antibodies. Note that each individual’s entire vaccination history must be known <em>a priori</em> and is an input into the transmission model. This is in contrast to other IBMs that simulate the time of vaccination, however, this is a conscious design choice. By not directly simulating the vaccination roll-out within the transmission model, we have the increased benefit of being able to directly incorporate known vaccination information and can quickly and efficiently switch out different vaccination scenarios. This is an important feature of the IBM when working with policy makers, allowing for the quick adaptation of the model to help answer policy relevant questions. At the point of initialisation each individual is assumed to be susceptible and to have zero neutralising antibodies. Once an individual is constructed, they are dynamically stored within a vector.</p>
<p>The spread of infection is modelled by directly simulating contact between infectious and susceptible individuals. For an infectious individual <span class="math inline">\(i\)</span> in age bracket <span class="math inline">\(n\)</span>, we sample the number of contacts that they make in age bracket <span class="math inline">\(m\)</span> from a negative binomial (NB) distribution, such that, <span class="math display">\[
C_m \sim \text{NB}\left(r\delta t, \frac{\Lambda_{n,m}}{r + \Lambda_{n,m}}\right),
\]</span> where <span class="math inline">\(C_m\)</span> (contacts/timestep) is the number of contacts made this timestep by the individual in age bracket <span class="math inline">\(m\)</span>, <span class="math inline">\(r\)</span> (contacts/day) is the overdispersion parameter, <span class="math inline">\(\delta t\)</span> (day) is the size of the current time step and <span class="math inline">\(\Lambda_{n,m}\)</span> (contacts/day) is the mean number of daily contacts between age bracket <span class="math inline">\(n\)</span> and <span class="math inline">\(m\)</span>. Note that we have used the definition of the negative binomial distribution where <span class="math inline">\(\text{NB}(r,p)\)</span> corresponds to probability density function <span class="math inline">\(f(k)={k + r -1 \choose r} p^k (1-p)^r\)</span>. We then sample <span class="math inline">\(C_m\)</span> contacts uniformly from individuals within the <span class="math inline">\(m\)</span>th age bracket. If contact <span class="math inline">\(j\)</span> is susceptible we determine if infection occurred using, <span class="math display">\[
    I \sim \text{Bernoulli}(\tau_i\xi_j),
\]</span> where <span class="math inline">\(I\)</span> is an indicator variable for successful infection, <span class="math inline">\(\tau_i\)</span> (dimensionless) is the infectiousness of the infectious individual <span class="math inline">\(i\)</span> and <span class="math inline">\(\xi_j\)</span> (dimensionless) is the susceptibility of the contact <span class="math inline">\(j\)</span>. We note that <span class="math inline">\(\tau_i\)</span> depends upon the transmission potential of the population of interest <span class="citation" data-cites="TPpaper">(<a href="#ref-TPpaper" role="doc-biblioref"><strong>TPpaper?</strong></a>)</span> and both <span class="math inline">\(\tau_i\)</span> and <span class="math inline">\(\xi_j\)</span> depend upon the underlying <a href="../models/immunitymodel.html">immunological model</a>, and the heterogeneous characteristics of the individual of interest (for example, <span class="math inline">\(\tau_i\)</span> will be altered depending on the symptom status of the infectious individual and both <span class="math inline">\(\tau_i\)</span> and <span class="math inline">\(\xi_j\)</span> will depend upon age). This process of generating contacts and the resulting infections is repeated over all age brackets.</p>
<p>At the point of infection, whether an individual will be asymptomatic or symptomatic is sampled from <span class="math display">\[
    Q \sim \text{Bernoulli}(q_i),
\]</span> where <span class="math inline">\(Q\)</span> is an indicator variable for symptomatic infection and <span class="math inline">\(q_i\)</span> is the probability that individual <span class="math inline">\(i\)</span> will be symptomatic, which depends on the age and neutralising antibody titre of individual <span class="math inline">\(i\)</span>. We also sample the time that the newly exposed individual becomes infectious, the time for the onset of symptoms and the time that the individual will recover. Given mandated isolation requirements in Australia at the time of study, we further simulate the time of isolation in relation to symptom onset, which reduces the individual’s duration of infectiousness. Note that each of these times are sampled from known distributions based on local case data <span class="citation" data-cites="TTIQpaper">(<a href="#ref-TTIQpaper" role="doc-biblioref"><strong>TTIQpaper?</strong></a>)</span>. These data have also been used to estimate the likely constraining impact on transmission of active case and contact finding and management, collectively termed test, trace, isolate, quarantine (TTIQ) <span class="citation" data-cites="TTIQpaper">(<a href="#ref-reopening" role="doc-biblioref"><strong>reopening?</strong></a>)</span>. We include a factor to account for a ‘partial TTIQ’ effect under high case loads as in earlier work <span class="citation" data-cites="reopening">(<a href="#ref-reopening" role="doc-biblioref"><strong>reopening?</strong></a>)</span>.</p>
<p>When the infectious individual recovers, we store the individual’s age, time of symptom onset, neutralising antibody titre at exposure, symptom indicator (<span class="math inline">\(Q\)</span>), the number of individuals they infected, their vaccine status (what was the latest vaccine they received) at exposure, the time they were isolated from the community and the number of times that they have been infected. This generates a line list of infections that is used to model <a href="../models/clinicaloutcomes.html">Clinical Outcomes</a>.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>