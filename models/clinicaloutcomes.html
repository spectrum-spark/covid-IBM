<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>COVID IBM: Waning Immunity - Clinical outcomes Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">COVID IBM: Waning Immunity</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../models/transmission.html">
 <span class="menu-text">Transmission Model</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../models/clinicaloutcomes.html" aria-current="page">
 <span class="menu-text">Clinical Outcomes Model</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../models/immunitymodel.html">
 <span class="menu-text">Immunity Model</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Clinical outcomes Model</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- Define all your latex macros within an equation environment -->
<p><span class="math display">\[
\newcommand{ICU}{\text{ICU}}
\]</span></p>
<div id="fig-clinicalcompartments" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="../pictures/clinical_pathways_compartments.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Depiction of the compartmental structure of the clinical pathways model.</figcaption><p></p>
</figure>
</div>
<p>The clinical outcomes model is based on the clinical model from <span class="citation" data-cites="Knock2021_key">Knock et al. (<a href="#ref-Knock2021_key" role="doc-biblioref">2021</a>)</span> and is an extension of the work done in <span class="citation" data-cites="reopening">Conway et al. (<a href="#ref-reopening" role="doc-biblioref">2022</a>)</span> and <span class="citation" data-cites="CommonwealthGovernmentofAustralia2021">Commonwealth Government of Australia (<a href="#ref-CommonwealthGovernmentofAustralia2021" role="doc-biblioref">2021</a>)</span>. This model extends on previous work by restructuring the existing model as a continuous-time, stochastic, IBM, where the neutralising antibody titre and age of the individual determines their transition probabilities. Furthermore, an emergency department (ED) compartment has been added as <span class="citation" data-cites="Moss2020_modelling">Moss et al. (<a href="#ref-Moss2020_modelling" role="doc-biblioref">2020</a>)</span> noted that limited ED consult capacity can cause a bottleneck that prevents admission to hospital. The full compartmental structure of the clinical outcomes model is depicted in <a href="#fig-clinicalcompartments">Figure&nbsp;1</a> .</p>
<p>All parameters governing the pathway each individual takes through the health system are altered depending upon their individual neutralising antibody titre. The evaluation of these transition probabilities are explained in full in the <a href="../models/immunitymodel.html">immunological model</a>.</p>
<p>For symptomatic individual <span class="math inline">\(i\)</span> in the line-list outputted from the <a href="../models/transmission.html">transmission model</a>, we determine if they are hospitalised by sampling, <span class="math display">\[
    H \sim \text{Bernoulli}(p_{H| I}^i)
\]</span> where <span class="math inline">\(H\)</span> is an indicator variable for hospitalisation and <span class="math inline">\(p_{H| I}^i\)</span> is the probability that individual <span class="math inline">\(i\)</span> is hospitalised given symptomatic infection. If individual <span class="math inline">\(i\)</span> requires hospitalisation they will present to the ED, where they may not be seen due to capacity limitations. ED consult capacity is modelled by admitting only the first <span class="math inline">\(C_{ED}\)</span> presentations to ED each day. If individual <span class="math inline">\(i\)</span> is not seen, they will present again to the ED with probability <span class="math inline">\(1 - p_{\text{L}|\text{ED}}\)</span> after <span class="math inline">\(\tau_{\text{L}|\text{ED}}\)</span> days sampled from, <span class="math display">\[
    \tau_{\text{L}|\text{ED}} \sim \text{Gamma}(\kappa_{\text{L}|\text{ED}}, \theta_{\text{L}|\text{ED}}),
\]</span> where <span class="math inline">\(p_{\text{L}|\text{ED}}\)</span> is the probability that an individual does not present again to the ED and <span class="math inline">\(\kappa_{\text{L}|\text{ED}}\)</span> and <span class="math inline">\(\theta_{\text{L}|\text{ED}}\)</span> are the shape and rate parameters of the gamma distribution respectively. For individuals that do not return to ED and are therefore not admitted to hospital, their age, neutralisation titre upon exposure and number of presentations to ED are recorded such that these can be used to understand possible excess mortality due to ED capacity limits. If individual <span class="math inline">\(i\)</span> is admitted to hospital we determine what hospital pathway they will follow.</p>
<p>There are three initial pathways for hospitalised individual <span class="math inline">\(i\)</span>. Individual <span class="math inline">\(i\)</span> will either recover and be discharged from a ward bed, die in a ward bed, or move to an ICU bed; as the three pathways have different length of stay distributions they modelled as three separate compartments <span class="math inline">\(H_R\)</span>, <span class="math inline">\(H_D\)</span> and <span class="math inline">\(\ICU_{pre}\)</span>. To determine which pathway individual <span class="math inline">\(i\)</span> will follow, we sample from, <span class="math display">\[
    X_h \sim \text{Categorical}({\bf p}_{1}^i)
\]</span> where <span class="math inline">\(X_h\)</span> is the sampled hospital pathway, <span class="math display">\[\begin{equation*}
{\bf p}_{1}^i= \left[p_{\ICU | H}^i, (1 - p_{\ICU |H}^i)p_{H_D|\ICU^c}^i, (1 - p_{\ICU}^i)(1 - p_{H_D|\ICU^c}^i)\right]
\end{equation*}\]</span> is a vector containing the probability of transitioning into <span class="math inline">\(\ICU_{pre}\)</span>, <span class="math inline">\(H_D\)</span>, or <span class="math inline">\(H_R\)</span> respectively, <span class="math inline">\(p_{\ICU|H}^i\)</span> is the probability that individual <span class="math inline">\(i\)</span> is admitted to ICU given they are hospitalised and <span class="math inline">\(p_{H_D|\ICU^c}^i\)</span> is the probability that individual <span class="math inline">\(i\)</span> dies on ward given that they are in hospitalised and are not going to ICU. If individual <span class="math inline">\(i\)</span> requires the ICU, they follow a further ICU pathway to determine their final outcome.</p>
<p>The pathway through the ICU also consists of three different components. Within the ICU pathway an individual will either die in the ICU (<span class="math inline">\(\ICU_D\)</span>), die in a ward bed after leaving the ICU (<span class="math inline">\(\ICU_{WD}\)</span>), or recover and be discharged from a ward bed after leaving the ICU (<span class="math inline">\(\ICU_{WR}\)</span>). We sample which pathway is taken within the ICU from, <span class="math display">\[
    X_\ICU \sim \text{Categorical}({\bf p}_{2}^i)
\]</span> where <span class="math inline">\(X_\ICU\)</span> is the sampled ICU pathway, <span class="math display">\[\begin{equation*}
{\bf p}_{2}^i = \left[p_{\ICU_D|\ICU}^i, (1 - p_{\ICU_D|\ICU}^i)p_{W_D|\ICU_D^c}^i, (1 - p_{\ICU_D|\ICU}^i)(1 - p_{W_D|\ICU_D^c}^i)\right]
\end{equation*}\]</span> is a vector containing the probability of transitioning into the <span class="math inline">\(\ICU_D\)</span>, <span class="math inline">\(\ICU_{WD}\)</span> or <span class="math inline">\(\ICU_{WR}\)</span> compartment respectively, <span class="math inline">\(p_{\ICU_D|\ICU}^i\)</span> is the probability that individual <span class="math inline">\(i\)</span> dies in the ICU given they were admitted to ICU and <span class="math inline">\(p_{W_D|\ICU_D^c}^i\)</span> is the probability that individual <span class="math inline">\(i\)</span> of dies in a ward bed after leaving ICU without dying. For an individual that transitions into <span class="math inline">\(\ICU_{WR}\)</span> or <span class="math inline">\(\ICU_{WD}\)</span>, they will move into a further ward compartment, <span class="math inline">\(W_R\)</span> or <span class="math inline">\(W_D\)</span>, where they will either recover or die respectively.</p>
<p>Finally, the length of stay for individual <span class="math inline">\(i\)</span> in each compartment is sampled such that, <span class="math display">\[
     \tau_c \sim \text{Gamma}(\kappa_c, \theta_c)
\]</span> where <span class="math inline">\(\tau_c\)</span> is the time spent in compartment <span class="math inline">\(c\)</span>, and <span class="math inline">\(\kappa_c\)</span> and <span class="math inline">\(\theta_c\)</span> are the shape and rate parameter for compartment <span class="math inline">\(c\)</span> respectively. Uncertainty is incorporated by sampling rate and shape parameters from the posterior estimated for the Australian Delta wave <span class="citation" data-cites="Tobin2022">(<a href="#ref-Tobin2022" role="doc-biblioref">Tobin et al. 2022</a>)</span>. <!-- The mean lengths of stay in each compartment by age are given in Table \ref{tab:clinical_los}. --></p>
<p>By generating a clinical timeline for every symptomatic individual, we can calculate hospital admissions, ICU occupancy, ward occupancy and deaths by age in continuous-time. Furthermore, by explicitly incorporating the effects of neutralising antibodies on protection against each outcome, we are able to account for individual level immune responses. Note that we assume that neutralising antibody titre levels do not change the distribution of time spent in any compartment.</p>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-CommonwealthGovernmentofAustralia2021" class="csl-entry" role="doc-biblioentry">
Commonwealth Government of Australia. 2021. <span>“National <span>Plan</span> to Transition <span>Australia</span>’s <span>National</span> <span>COVID</span>-19 <span>Response</span>.”</span> <em>Australia</em>. <a href="https://www.australia.gov.au/national-plan">https://www.australia.gov.au/national-plan</a>.
</div>
<div id="ref-reopening" class="csl-entry" role="doc-biblioentry">
Conway, Eamon, Camelia Walker, Chris Baker, Michael Lydeamore, Gerard E Ryan, Trish Campbell, Joel C Miller, et al. 2022. <span>“COVID-19 Vaccine Coverage Targets to Inform Reopening Plans in a Low Incidence Setting.”</span> <em>medRxiv</em>, 2022–12.
</div>
<div id="ref-Knock2021_key" class="csl-entry" role="doc-biblioentry">
Knock, Edward S., Lilith K. Whittles, John A. Lees, Pablo N. Perez-Guzman, Robert Verity, Richard G. FitzJohn, Katy A. M. Gaythorpe, et al. 2021. <span>“Key Epidemiological Drivers and Impact of Interventions in the 2020 SARS-CoV-2 Epidemic in England.”</span> <em>Science Translational Medicine</em> 13 (602): eabg4262. <a href="https://doi.org/10.1126/scitranslmed.abg4262">https://doi.org/10.1126/scitranslmed.abg4262</a>.
</div>
<div id="ref-Moss2020_modelling" class="csl-entry" role="doc-biblioentry">
Moss, R, J Wood, D Brown, F Shearer, AJ Black, AC Cheng, JM McCaw, and J McVernon. 2020. <span>“Modelling the Impact of COVID-19 in Australia to Inform Transmission Reducing Measures and Health System Preparedness.”</span> <em>medRxiv</em>. <a href="https://doi.org/10.1101/2020.04.07.20056184">https://doi.org/10.1101/2020.04.07.20056184</a>.
</div>
<div id="ref-Tobin2022" class="csl-entry" role="doc-biblioentry">
Tobin, Ruarai J, James G Wood, Duleepa Jayasundara, Grant Sara, James Walker, Genevieve E Martin, James M McCaw, Freya M Shearer, and David J Price. 2022. <span>“Hospital Length of Stay in a Mixed Omicron and Delta Epidemic in New South Wales, Australia.”</span> <em>medRxiv</em>. <a href="https://doi.org/10.1101/2022.03.16.22271361">https://doi.org/10.1101/2022.03.16.22271361</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>